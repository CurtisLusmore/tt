<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Table Tennis Scorer</title>
    <script src="confetti.min.js"></script>
    <style>
      body {
        width: 100%;
        margin: 0;
      }
      span {
        display: inline-block;
        text-align: center;
        width: 50%;
        cursor: pointer;
      }
      span.big {
        font-size: 70vh;
        height: 80vh;
      }
      span.small {
        font-size: 10vh;
        height: 20vh;
      }
      canvas {
        position: absolute;
        left: 0;
        top: 0;
      }
    </style>
  </head>
  <body>
    <span id="0" class="big" onclick="count(0)">0</span><span id="1" class="big" onclick="count(1)">0</span>
    <span class="small" onclick="undo(0)">-1</span><span class="small" onclick="undo(1)">-1</span>
    <canvas id="confetti-canvas" style="display: none;" height="100%" width="100%" onclick="reset()"></canvas>
    <script>
      const counters = [
        document.getElementById('0'),
        document.getElementById('1')
      ]
      maxParticleCount = 1000;
      const count = function (id) {
        const other = (id+1)%2;
        const scores = counters.map(elem => parseInt(elem.innerHTML));
        counters[id].innerHTML = ++scores[id];
        if (scores[id] === 21 && scores[other] <= 19 ||
          scores[id] > 21 && scores[id]-2 >= scores[other]) {
          win();
        }
      };
      const undo = function (id) {
        const elem = counters[id];
        elem.innerHTML = parseInt(elem.innerHTML) - 1;
      };
      const win = function () {
        const canvas = document.getElementById('confetti-canvas')
        canvas.style.display = null;
        canvas.style.height = '100%';
        canvas.style.width = '100%';
        canvas.height = canvas.offsetHeight;
        canvas.width = canvas.offsetWidth;
        startConfetti();
      };
      const reset = function () {
        document.getElementById('confetti-canvas').style.display = 'none';
        counters[0].innerHTML = 0;
        counters[1].innerHTML = 0;
        stopConfetti();
        removeConfetti();
      }
    </script>
  </body>
</html>